<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ é’æ£®Adventure 2025</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { width: 100%; height: 100%; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
        body { background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; display: flex; flex-direction: column; min-height: 100vh; background: white; }
        .header { background: white; padding: 20px 16px; text-align: center; border-bottom: 1px solid #eee; position: sticky; top: 0; z-index: 20; }
        .header h1 { font-size: 24px; margin-bottom: 8px; color: #dc3545; font-weight: 700; }
        .header p { font-size: 12px; color: #999; }
        .content { flex: 1; overflow-y: auto; padding: 0; padding-bottom: 80px; }
        .tab-content { display: none; min-height: 100%; }
        .tab-content.active { display: block; }
        #home-tab { background: linear-gradient(180deg, rgba(230, 245, 255, 0.6) 0%, rgba(200, 235, 255, 0.4) 100%); padding: 16px; }
        .weather-container { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px; }
        .weather-card { background: white; border-radius: 20px; padding: 16px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 4px 12px rgba(100, 200, 230, 0.2); }
        .weather-info { display: flex; flex-direction: column; }
        .weather-location { font-size: 13px; font-weight: 500; margin-bottom: 4px; color: #666; }
        .weather-temp { font-size: 32px; font-weight: 800; color: #333; }
        .quick-cards-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px; }
        .current-activity-card, .upcoming-activities-card { border-radius: 24px; color: white; display: flex; flex-direction: column; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15); min-height: 240px; padding: 20px; position: relative; }
        .current-activity-card { background: linear-gradient(135deg, #888888 0%, #5a5a5a 100%); justify-content: flex-end; align-items: center; text-align: center; }
        .upcoming-activities-card { background: linear-gradient(135deg, #8b6f47 0%, #6b5344 100%); justify-content: flex-start; align-items: flex-start; text-align: left; }
        .current-activity-icon { font-size: 56px; margin-bottom: 16px; }
        .current-activity-title { font-size: 16px; font-weight: 700; margin-bottom: 8px; }
        .current-activity-label { font-size: 13px; font-weight: 600; }
        .upcoming-activities-header { margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid rgba(255, 255, 255, 0.3); }
        .upcoming-activities-title { font-size: 13px; font-weight: 700; text-transform: uppercase; }
        .upcoming-activities-list { display: flex; flex-direction: column; gap: 10px; flex: 1; }
        .upcoming-item { background: rgba(255, 255, 255, 0.15); border-left: 3px solid rgba(255, 255, 255, 0.8); padding: 10px 12px; border-radius: 8px; }
        .upcoming-item-time { font-size: 11px; font-weight: 700; margin-bottom: 3px; }
        .upcoming-item-activity { font-size: 12px; font-weight: 600; }
        .widget { border-radius: 24px; padding: 24px; margin: 0 16px 16px 16px; color: white; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); background: linear-gradient(135deg, #64c8e6, #4aafcc); }
        .widget-title { font-size: 13px; font-weight: 700; margin-bottom: 14px; text-transform: uppercase; }
        .schedule-item { background: rgba(255, 255, 255, 0.18); padding: 14px; border-radius: 14px; margin-bottom: 10px; border-left: 3px solid rgba(255, 255, 255, 0.7); }
        .schedule-time { font-size: 11px; font-weight: 700; margin-bottom: 5px; }
        .schedule-activity { font-size: 13px; font-weight: 600; }
        #map { width: 100%; height: calc(100vh - 160px); }
        .map-legend { position: absolute; bottom: 80px; left: 12px; background: white; padding: 12px 16px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); z-index: 20; max-width: 240px; }
        .map-legend-title { font-size: 12px; font-weight: 700; margin-bottom: 8px; color: #333; }
        .map-legend-item { font-size: 11px; margin-bottom: 6px; display: flex; align-items: center; gap: 8px; }
        .map-legend-color { width: 16px; height: 16px; border-radius: 50%; }
        .map-legend-line { width: 20px; height: 3px; border-radius: 2px; }
        #schedule-tab { padding: 16px; }
        .calendar-day { background: white; border-radius: 14px; padding: 18px; border-left: 5px solid #dc3545; box-shadow: 0 2px 8px rgba(100, 200, 230, 0.15); margin-bottom: 14px; }
        .day-date { font-size: 18px; font-weight: 800; color: #dc3545; margin-bottom: 14px; }
        .activity-item { display: flex; gap: 14px; padding: 12px; background: rgba(230, 245, 255, 0.5); border-radius: 10px; border-left: 3px solid #64c8e6; margin-bottom: 10px; font-size: 13px; }
        .activity-time { font-weight: 700; color: #dc3545; min-width: 65px; font-size: 12px; }
        .activity-details { color: #333; flex: 1; }
        .activity-text { font-weight: 600; margin-bottom: 3px; }
        .activity-meta { font-size: 11px; color: #999; }
        .location-link { color: #0066cc; text-decoration: underline; cursor: pointer; font-weight: 600; }
        .location-link:hover { color: #0052a3; }
        .nav { position: fixed; bottom: 0; left: 0; right: 0; max-width: 800px; margin: 0 auto; display: flex; background: white; border-top: 1px solid #eee; box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.08); z-index: 100; }
        .nav-btn { flex: 1; padding: 12px 8px; border: none; background: transparent; cursor: pointer; font-size: 20px; display: flex; flex-direction: column; align-items: center; gap: 4px; color: #ccc; transition: all 0.2s; }
        .nav-btn span { font-size: 9px; font-weight: 500; }
        .nav-btn.active { color: #dc3545; }
        .nav-btn.active span { font-weight: 700; }
        .padding-wrapper { padding: 0 16px; }
        @media (max-width: 600px) { .quick-cards-grid { grid-template-columns: 1fr; } .weather-container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ é’æ£®Adventure 2025</h1>
            <p>12/23 - 12/31 | å†¬ã®ç¥­å…¸ â„ï¸ ã‚Šã‚“ã” ğŸ</p>
        </div>

        <div class="content">
            <!-- HOME TAB -->
            <div id="home-tab" class="tab-content active">
                <div class="weather-container">
                    <div class="weather-card">
                        <div class="weather-info">
                            <div class="weather-location">ğŸ—¼ æ±äº¬</div>
                            <div class="weather-temp">12Â°</div>
                        </div>
                        <div style="font-size: 48px;">â›…</div>
                    </div>
                    <div class="weather-card">
                        <div class="weather-info">
                            <div class="weather-location">ğŸ”ï¸ é’æ£®</div>
                            <div class="weather-temp">-2Â°</div>
                        </div>
                        <div style="font-size: 48px;">â„ï¸</div>
                    </div>
                </div>

                <div class="padding-wrapper">
                    <div class="quick-cards-grid">
                        <div class="current-activity-card">
                            <div class="current-activity-icon">ğŸ—“ï¸</div>
                            <div class="current-activity-title">æº–å‚™å‡ºç™¼</div>
                            <div class="current-activity-label">ç›®å‰è¡Œç¨‹</div>
                        </div>
                        <div class="upcoming-activities-card">
                            <div class="upcoming-activities-header">
                                <div class="upcoming-activities-title">ğŸ“… å³å°‡åˆ°ä¾†</div>
                            </div>
                            <div class="upcoming-activities-list" id="upcoming-list"></div>
                        </div>
                    </div>
                </div>

                <div class="widget">
                    <div class="widget-title">ğŸ“ ä»Šæ—¥è¡Œç¨‹</div>
                    <div id="today-activities"></div>
                </div>
            </div>

            <!-- SCHEDULE TAB -->
            <div id="schedule-tab" class="tab-content">
                <div id="calendar-list"></div>
            </div>

            <!-- MAP TAB -->
            <div id="map-tab" class="tab-content" style="padding: 0; position: relative;">
                <div id="map"></div>
                <div class="map-legend">
                    <div class="map-legend-title">ğŸ—ºï¸ è¡Œç¨‹è·¯ç·š</div>
                    <div class="map-legend-item">
                        <div class="map-legend-color" style="background: #dc3545;"></div>
                        <span>æ™¯é»ä½ç½®</span>
                    </div>
                    <div class="map-legend-item">
                        <div class="map-legend-line" style="background: #dc3545;"></div>
                        <span>ç§»å‹•è·¯ç·š</span>
                    </div>
                    <div class="map-legend-item">
                        <div class="map-legend-line" style="background: #5cb85c;"></div>
                        <span>JR ç§»å‹•</span>
                    </div>
                    <div class="map-legend-item">
                        <div class="map-legend-line" style="background: #003d7a;"></div>
                        <span>Skyliner</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- NAVIGATION -->
        <div class="nav">
            <button class="nav-btn active" onclick="switchTab('home')">
                <span>é¦–é </span>ğŸ 
            </button>
            <button class="nav-btn" onclick="switchTab('schedule')">
                <span>è¡Œç¨‹</span>ğŸ“…
            </button>
            <button class="nav-btn" onclick="switchTab('map')">
                <span>åœ°åœ–</span>ğŸ—ºï¸
            </button>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const locationCoords = {
            "å°åŒ—": {lat: 25.0330, lng: 121.5654},
            "æ¡ƒåœ’æ©Ÿå ´": {lat: 25.0797, lng: 121.2342},
            "æ±äº¬æˆç”°æ©Ÿå ´": {lat: 35.7653, lng: 140.3931},
            "æ±äº¬éŠ€åº§": {lat: 35.6729, lng: 139.7706},
            "å±±å½¢å¸‚": {lat: 38.2405, lng: 140.3630},
            "è—ç‹æ¨¹å†°": {lat: 37.7431, lng: 140.5953},
            "ç‹ç‹¸æ‘": {lat: 38.7552, lng: 141.1193},
            "éŠ€å±±æº«æ³‰": {lat: 38.3233, lng: 140.5014},
            "è§’é¤¨": {lat: 39.3542, lng: 140.5653},
            "ç”°æ¾¤æ¹–": {lat: 39.7314, lng: 140.5906},
            "å¥§å…¥ç€¨æºª": {lat: 40.6167, lng: 140.9333},
            "é’æ£®": {lat: 40.8244, lng: 140.7447},
            "æ–°é’æ£®ç«™": {lat: 40.7426, lng: 140.7389}
        };

        const tripData = [
            {æ—¥æœŸ: "12/23", æ™‚é–“: "ä¸Šåˆ 7:30", å‡ºç™¼: "å°åŒ—å‡ºç™¼", äº¤é€š: "", ä½å®¿: "Henn na Hotel Tokyo Ginza", è²»ç”¨: "", åœ°é»: "å°åŒ—"},
            {æ—¥æœŸ: "12/23", æ™‚é–“: "ä¸Šåˆ 10:40", å‡ºç™¼: "æ¡ƒåœ’æ©Ÿå ´", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "æ¡ƒåœ’æ©Ÿå ´"},
            {æ—¥æœŸ: "12/23", æ™‚é–“: "ä¸‹åˆ 2:55", å‡ºç™¼: "æ±äº¬æˆç”°æ©Ÿå ´", äº¤é€š: "Skyliner", ä½å®¿: "", è²»ç”¨: "NT$2,885", åœ°é»: "æ±äº¬æˆç”°æ©Ÿå ´", transport: "Skyliner"},
            {æ—¥æœŸ: "12/23", æ™‚é–“: "ä¸‹åˆ 4:00", å‡ºç™¼: "Henn na Hotel check-in", äº¤é€š: "", ä½å®¿: "æ±äº¬éŠ€åº§", è²»ç”¨: "", åœ°é»: "æ±äº¬éŠ€åº§", transport: "Skyliner"},
            {æ—¥æœŸ: "12/23", æ™‚é–“: "ä¸‹åˆ 6:00", å‡ºç™¼: "Hakatagekijo Yurakucho", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "æ±äº¬éŠ€åº§"},
            {æ—¥æœŸ: "12/23", æ™‚é–“: "ä¸‹åˆ 8:00", å‡ºç™¼: "è³¼ç‰© è²·å¤–å¥—", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "æ±äº¬éŠ€åº§"},
            {æ—¥æœŸ: "12/23", æ™‚é–“: "ä¸‹åˆ 11:00", å‡ºç™¼: "å›æ±äº¬ä½å®¿", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "æ±äº¬éŠ€åº§"},
            {æ—¥æœŸ: "12/24", æ™‚é–“: "ä¸Šåˆ 9:00", å‡ºç™¼: "æ±äº¬æ—©é¤", äº¤é€š: "JR Tsubasa", ä½å®¿: "å±±å½¢å¸‚SUPER HOTEL", è²»ç”¨: "", åœ°é»: "æ±äº¬éŠ€åº§", isJR: true},
            {æ—¥æœŸ: "12/24", æ™‚é–“: "ä¸Šåˆ 10:00", å‡ºç™¼: "é€›è¡—", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "æ±äº¬éŠ€åº§"},
            {æ—¥æœŸ: "12/24", æ™‚é–“: "ä¸‹åˆ 3:00", å‡ºç™¼: "JRå¾€å±±å½¢", äº¤é€š: "JR Tsubasa 143", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "å±±å½¢å¸‚", isJR: true},
            {æ—¥æœŸ: "12/24", æ™‚é–“: "ä¸‹åˆ 6:00", å‡ºç™¼: "SUPER HOTEL check-in", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "å±±å½¢å¸‚"},
            {æ—¥æœŸ: "12/24", æ™‚é–“: "ä¸‹åˆ 7:00", å‡ºç™¼: "å±±å½¢å¸‚æ™šé¤", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "å±±å½¢å¸‚"},
            {æ—¥æœŸ: "12/24", æ™‚é–“: "ä¸‹åˆ 10:00", å‡ºç™¼: "å›å±±å½¢ä½å®¿", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "å±±å½¢å¸‚"},
            {æ—¥æœŸ: "12/25", æ™‚é–“: "ä¸Šåˆ 9:00", å‡ºç™¼: "SUPER HOTELæ—©é¤", äº¤é€š: "å¤§çœ¾é‹è¼¸", ä½å®¿: "å±±å½¢å¸‚SUPER HOTEL", è²»ç”¨: "", åœ°é»: "å±±å½¢å¸‚"},
            {æ—¥æœŸ: "12/25", æ™‚é–“: "ä¸Šåˆ 10:00", å‡ºç™¼: "æ­å¤§çœ¾é‹è¼¸", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "å±±å½¢å¸‚"},
            {æ—¥æœŸ: "12/25", æ™‚é–“: "ä¸Šåˆ 11:00", å‡ºç™¼: "è—ç‹æ¨¹å†°æ»‘é›ª", äº¤é€š: "å·´å£«", ä½å®¿: "", è²»ç”¨: "Â¥4,700", åœ°é»: "è—ç‹æ¨¹å†°"},
            {æ—¥æœŸ: "12/25", æ™‚é–“: "ä¸‹åˆ 5:00", å‡ºç™¼: "å›å±±å½¢å¸‚", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "å±±å½¢å¸‚"},
            {æ—¥æœŸ: "12/25", æ™‚é–“: "ä¸‹åˆ 6:00", å‡ºç™¼: "å±±å½¢å¸‚æ™šé¤", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "å±±å½¢å¸‚"},
            {æ—¥æœŸ: "12/25", æ™‚é–“: "ä¸‹åˆ 10:00", å‡ºç™¼: "å›å±±å½¢ä½å®¿", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "å±±å½¢å¸‚"},
            {æ—¥æœŸ: "12/26", æ™‚é–“: "ä¸Šåˆ 9:00", å‡ºç™¼: "å±±å½¢å¸‚æ—©é¤", äº¤é€š: "ç§Ÿè»Š", ä½å®¿: "å±±å½¢å¸‚SUPER HOTEL", è²»ç”¨: "", åœ°é»: "å±±å½¢å¸‚"},
            {æ—¥æœŸ: "12/26", æ™‚é–“: "ä¸Šåˆ 10:00", å‡ºç™¼: "ç§Ÿè»Š", äº¤é€š: "Toyota rent a car", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "å±±å½¢å¸‚"},
            {æ—¥æœŸ: "12/26", æ™‚é–“: "ä¸Šåˆ 11:00", å‡ºç™¼: "ç‹ç‹¸æ‘", äº¤é€š: "é–‹è»Š", ä½å®¿: "", è²»ç”¨: "Â¥1,000", åœ°é»: "ç‹ç‹¸æ‘"},
            {æ—¥æœŸ: "12/26", æ™‚é–“: "ä¸‹åˆ 3:00", å‡ºç™¼: "éŠ€å±±æº«æ³‰check-in", äº¤é€š: "é–‹è»Š", ä½å®¿: "", è²»ç”¨: "Â¥3,000", åœ°é»: "éŠ€å±±æº«æ³‰"},
            {æ—¥æœŸ: "12/26", æ™‚é–“: "ä¸‹åˆ 6:00", å‡ºç™¼: "å±±å½¢å¸‚æ™šé¤", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "å±±å½¢å¸‚"},
            {æ—¥æœŸ: "12/26", æ™‚é–“: "ä¸‹åˆ 10:00", å‡ºç™¼: "å›å±±å½¢ä½å®¿", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "å±±å½¢å¸‚"},
            {æ—¥æœŸ: "12/27", æ™‚é–“: "ä¸Šåˆ 8:30", å‡ºç™¼: "å±±å½¢å¸‚å‡ºç™¼", äº¤é€š: "ç§Ÿè»Š", ä½å®¿: "ç”°æ¾¤æ¹–", è²»ç”¨: "", åœ°é»: "å±±å½¢å¸‚"},
            {æ—¥æœŸ: "12/27", æ™‚é–“: "ä¸‹åˆ 12:00", å‡ºç™¼: "è§’é¤¨æ­¦å®¶å±‹æ•·", äº¤é€š: "é–‹è»Š", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "è§’é¤¨"},
            {æ—¥æœŸ: "12/27", æ™‚é–“: "ä¸‹åˆ 3:00", å‡ºç™¼: "ç”°æ¾¤æ¹–check-in", äº¤é€š: "é–‹è»Š", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "ç”°æ¾¤æ¹–"},
            {æ—¥æœŸ: "12/27", æ™‚é–“: "ä¸‹åˆ 5:00", å‡ºç™¼: "é‚„è»Š", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "ç”°æ¾¤æ¹–"},
            {æ—¥æœŸ: "12/27", æ™‚é–“: "ä¸‹åˆ 7:00", å‡ºç™¼: "æ™šé¤", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "ç”°æ¾¤æ¹–"},
            {æ—¥æœŸ: "12/28", æ™‚é–“: "ä¸Šåˆ 9:00", å‡ºç™¼: "æ—©é¤", äº¤é€š: "", ä½å®¿: "ç”°æ¾¤æ¹–", è²»ç”¨: "", åœ°é»: "ç”°æ¾¤æ¹–"},
            {æ—¥æœŸ: "12/28", æ™‚é–“: "ä¸Šåˆ 10:00", å‡ºç™¼: "ç”°æ¾¤æ¹–æ»‘é›ªå ´", äº¤é€š: "é£¯åº—æ¥é§", ä½å®¿: "", è²»ç”¨: "Â¥5,000", åœ°é»: "ç”°æ¾¤æ¹–"},
            {æ—¥æœŸ: "12/28", æ™‚é–“: "ä¸‹åˆ 5:00", å‡ºç™¼: "å›ä½å®¿", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "ç”°æ¾¤æ¹–"},
            {æ—¥æœŸ: "12/28", æ™‚é–“: "ä¸‹åˆ 6:00", å‡ºç™¼: "æ™šé¤+è‡ªç”±æ´»å‹•", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "ç”°æ¾¤æ¹–"},
            {æ—¥æœŸ: "12/29", æ™‚é–“: "ä¸Šåˆ 9:00", å‡ºç™¼: "ç”°æ¾¤æ¹–ç§Ÿè»Š", äº¤é€š: "ç§Ÿè»Š", ä½å®¿: "æ˜Ÿé‡å¥§å…¥ç€¨æºª", è²»ç”¨: "", åœ°é»: "ç”°æ¾¤æ¹–"},
            {æ—¥æœŸ: "12/29", æ™‚é–“: "ä¸‹åˆ 12:00", å‡ºç™¼: "æ˜Ÿé‡åˆé¤", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "å¥§å…¥ç€¨æºª"},
            {æ—¥æœŸ: "12/29", æ™‚é–“: "ä¸‹åˆ 1:45", å‡ºç™¼: "å¥§å…¥ç€¨æºªTour", äº¤é€š: "å·´å£«", ä½å®¿: "", è²»ç”¨: "Â¥2,100", åœ°é»: "å¥§å…¥ç€¨æºª"},
            {æ—¥æœŸ: "12/29", æ™‚é–“: "ä¸‹åˆ 4:25", å‡ºç™¼: "é£¯åº—æ´»å‹•", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "å¥§å…¥ç€¨æºª"},
            {æ—¥æœŸ: "12/29", æ™‚é–“: "ä¸‹åˆ 7:20", å‡ºç™¼: "è˜‹æœé¤å»³æ™šé¤", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "å¥§å…¥ç€¨æºª"},
            {æ—¥æœŸ: "12/30", æ™‚é–“: "ä¸Šåˆ 9:00", å‡ºç™¼: "å¥§å…¥ç€¨æºªæ—©é¤", äº¤é€š: "é–‹è»Š", ä½å®¿: "æ±äº¬TBA", è²»ç”¨: "", åœ°é»: "å¥§å…¥ç€¨æºª"},
            {æ—¥æœŸ: "12/30", æ™‚é–“: "ä¸Šåˆ 10:00", å‡ºç™¼: "é’æ£®", äº¤é€š: "é–‹è»Š", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "é’æ£®"},
            {æ—¥æœŸ: "12/30", æ™‚é–“: "ä¸‹åˆ 12:00", å‡ºç™¼: "é’æ£®åˆé¤", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "é’æ£®"},
            {æ—¥æœŸ: "12/30", æ™‚é–“: "ä¸‹åˆ 6:00", å‡ºç™¼: "é‚„è»Š", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "é’æ£®"},
            {æ—¥æœŸ: "12/30", æ™‚é–“: "ä¸‹åˆ 7:44", å‡ºç™¼: "JR Hayabusaå¾€æ±äº¬", äº¤é€š: "JR Hayabusa", ä½å®¿: "", è²»ç”¨: "Â¥54,210", åœ°é»: "æ–°é’æ£®ç«™", isJR: true},
            {æ—¥æœŸ: "12/30", æ™‚é–“: "ä¸‹åˆ 11:04", å‡ºç™¼: "æ±äº¬è»Šç«™", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "æ±äº¬éŠ€åº§", isJR: true},
            {æ—¥æœŸ: "12/30", æ™‚é–“: "ä¸‹åˆ 11:40", å‡ºç™¼: "ä½å®¿check-in", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "æ±äº¬éŠ€åº§"},
            {æ—¥æœŸ: "12/31", æ™‚é–“: "ä¸Šåˆ 9:00", å‡ºç™¼: "æ±äº¬åƒæ—©é¤", äº¤é€š: "", ä½å®¿: "å°åŒ—", è²»ç”¨: "", åœ°é»: "æ±äº¬éŠ€åº§"},
            {æ—¥æœŸ: "12/31", æ™‚é–“: "ä¸Šåˆ 10:00", å‡ºç™¼: "é€›è¡— è²·ä¼´æ‰‹ç¦®", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "æ±äº¬éŠ€åº§"},
            {æ—¥æœŸ: "12/31", æ™‚é–“: "ä¸‹åˆ 12:00", å‡ºç™¼: "æ±äº¬åˆé¤", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "æ±äº¬éŠ€åº§"},
            {æ—¥æœŸ: "12/31", æ™‚é–“: "ä¸‹åˆ 6:25", å‡ºç™¼: "å¾€æˆç”°æ©Ÿå ´", äº¤é€š: "Skyliner", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "æ±äº¬æˆç”°æ©Ÿå ´", transport: "Skyliner"},
            {æ—¥æœŸ: "12/31", æ™‚é–“: "ä¸‹åˆ 9:50", å‡ºç™¼: "æ¡ƒåœ’æ©Ÿå ´", äº¤é€š: "", ä½å®¿: "å°åŒ—", è²»ç”¨: "", åœ°é»: "æ¡ƒåœ’æ©Ÿå ´"},
            {æ—¥æœŸ: "12/31", æ™‚é–“: "ä¸‹åˆ 11:30", å‡ºç™¼: "æº–å‚™è·¨å¹´", äº¤é€š: "", ä½å®¿: "", è²»ç”¨: "", åœ°é»: "å°åŒ—"}
        ];

        let map;
        function openGoogleMaps(location) {
            const url = `https://www.google.com/maps/search/${encodeURIComponent(location)}`;
            window.open(url, '_blank');
        }

        function initMap() {
            map = L.map('map').setView([38.5, 140.5], 6);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap',
                maxZoom: 19
            }).addTo(map);

            const uniqueLocations = {};
            tripData.forEach(trip => {
                if (trip.åœ°é» && locationCoords[trip.åœ°é»] && !uniqueLocations[trip.åœ°é»]) {
                    const loc = locationCoords[trip.åœ°é»];
                    uniqueLocations[trip.åœ°é»] = true;
                    L.circleMarker([loc.lat, loc.lng], {
                        radius: 8,
                        fillColor: '#dc3545',
                        color: '#fff',
                        weight: 2,
                        opacity: 1,
                        fillOpacity: 0.8
                    }).bindPopup(`<strong>${trip.åœ°é»}</strong><br/><button onclick="openGoogleMaps('${trip.åœ°é»}')" style="width:100%;padding:8px;margin-top:8px;background:#dc3545;color:white;border:none;border-radius:4px;cursor:pointer;">ğŸ“ åœ¨Google Mapsé–‹å•Ÿ</button>`).addTo(map);
                }
            });

            const coords = [], jrCoords = [], skylineCoords = [];
            const uniqueCoordKeys = new Set(), uniqueJRKeys = new Set(), uniqueSkylineKeys = new Set();

            tripData.forEach(trip => {
                if (trip.åœ°é» && locationCoords[trip.åœ°é»]) {
                    const loc = locationCoords[trip.åœ°é»];
                    const key = `${loc.lat},${loc.lng}`;
                    if (trip.isJR) {
                        if (!uniqueJRKeys.has(key)) {
                            jrCoords.push([loc.lat, loc.lng]);
                            uniqueJRKeys.add(key);
                        }
                    } else if (trip.transport === 'Skyliner') {
                        if (!uniqueSkylineKeys.has(key)) {
                            skylineCoords.push([loc.lat, loc.lng]);
                            uniqueSkylineKeys.add(key);
                        }
                    } else {
                        if (!uniqueCoordKeys.has(key)) {
                            coords.push([loc.lat, loc.lng]);
                            uniqueCoordKeys.add(key);
                        }
                    }
                }
            });

            if (coords.length > 1) L.polyline(coords, {color: '#dc3545', weight: 3, opacity: 0.7, dashArray: '5, 5'}).addTo(map);
            if (jrCoords.length > 1) L.polyline(jrCoords, {color: '#5cb85c', weight: 3, opacity: 0.8, dashArray: '10, 5'}).addTo(map);
            if (skylineCoords.length > 1) L.polyline(skylineCoords, {color: '#003d7a', weight: 3, opacity: 0.9, dashArray: '8, 4'}).addTo(map);
        }

        function renderSchedule() {
            const grouped = {};
            tripData.forEach(row => {
                if (!grouped[row.æ—¥æœŸ]) grouped[row.æ—¥æœŸ] = [];
                grouped[row.æ—¥æœŸ].push(row);
            });
            let html = '';
            Object.keys(grouped).forEach(date => {
                html += `<div class="calendar-day"><div class="day-date">ğŸ“… ${date}</div>`;
                grouped[date].forEach(row => {
                    html += `<div class="activity-item"><div class="activity-time">${row.æ™‚é–“}</div><div class="activity-details"><div class="activity-text">${row.å‡ºç™¼}</div><div class="activity-meta"><span class="location-link" onclick="openGoogleMaps('${row.åœ°é»}')">${row.åœ°é»}</span> ${row.äº¤é€š || ''} ${row.ä½å®¿ ? 'ğŸ¨ ' + row.ä½å®¿ : ''} ${row.è²»ç”¨ ? 'ğŸ’° ' + row.è²»ç”¨ : ''}</div></div></div>`;
                });
                html += '</div>';
            });
            document.getElementById('calendar-list').innerHTML = html;
        }

        function updateUpcomingActivities() {
            const upcoming = tripData.slice(0, 2);
            let html = '';
            upcoming.forEach(item => {
                html += `<div class="upcoming-item"><div class="upcoming-item-time">${item.æ—¥æœŸ} ${item.æ™‚é–“}</div><div class="upcoming-item-activity">${item.å‡ºç™¼}</div></div>`;
            });
            document.getElementById('upcoming-list').innerHTML = html;
        }

        function updateTodayActivities() {
            document.getElementById('today-activities').innerHTML = '<div class="schedule-item"><div class="schedule-activity">æº–å‚™å‡ºç™¼åˆ°é’æ£®ï¼</div></div>';
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
            const tabMap = {'home': 'home-tab', 'schedule': 'schedule-tab', 'map': 'map-tab'};
            document.getElementById(tabMap[tab]).classList.add('active');
            event.target.closest('.nav-btn').classList.add('active');
            if (tab === 'map' && map === undefined) setTimeout(initMap, 100);
        }

        renderSchedule();
        updateUpcomingActivities();
        updateTodayActivities();
    </script>
</body>
</html>